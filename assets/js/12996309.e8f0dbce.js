"use strict";(self.webpackChunkzhenxun_docs=self.webpackChunkzhenxun_docs||[]).push([[144],{5197:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>a,contentTitle:()=>i,default:()=>m,frontMatter:()=>r,metadata:()=>d,toc:()=>l});var o=s(4848),t=s(8453);const r={title:"\u57fa\u7840\u6570\u636e",subSidebar:!1},i=void 0,d={id:"development/base_data",title:"\u57fa\u7840\u6570\u636e",description:"\u57fa\u7840\u6570\u636e",source:"@site/docs/development/base_data.md",sourceDirName:"development",slug:"/development/base_data",permalink:"/zhenxun_bot/development/base_data",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/development/base_data.md",tags:[],version:"current",frontMatter:{title:"\u57fa\u7840\u6570\u636e",subSidebar:!1},sidebar:"devSidebar",next:{title:"\u914d\u7f6e\u7ba1\u7406",permalink:"/zhenxun_bot/development/config"}},a={},l=[{value:"\u57fa\u7840\u6570\u636e",id:"\u57fa\u7840\u6570\u636e",level:2},{value:"\u597d\u611f\u5ea6",id:"\u597d\u611f\u5ea6",level:3},{value:"\u91d1\u5e01/\u9053\u5177",id:"\u91d1\u5e01\u9053\u5177",level:3},{value:"\u597d\u53cb/\u7fa4\u7ec4\u5217\u8868",id:"\u597d\u53cb\u7fa4\u7ec4\u5217\u8868",level:2},{value:"\u597d\u53cb\u5217\u8868",id:"\u597d\u53cb\u5217\u8868",level:3},{value:"\u7fa4\u7ec4\u5217\u8868",id:"\u7fa4\u7ec4\u5217\u8868",level:3},{value:"\u5176\u4ed6",id:"\u5176\u4ed6",level:2},{value:"\u83b7\u53d6\u5e73\u53f0",id:"\u83b7\u53d6\u5e73\u53f0",level:3}];function u(n){const e={code:"code",h2:"h2",h3:"h3",pre:"pre",...(0,t.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h2,{id:"\u57fa\u7840\u6570\u636e",children:"\u57fa\u7840\u6570\u636e"}),"\n",(0,o.jsx)(e.h3,{id:"\u597d\u611f\u5ea6",children:"\u597d\u611f\u5ea6"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:"from zhenxun.models.sign_user import SignUser\n\n# \u83b7\u53d6\u7528\u6237\u7b7e\u5230\u6570\u636e\nsign_user = await SignUser.get_or_none(user_id=user_id)\n\n# \u597d\u611f\u5ea6\nimpression = sign_user.impression\n\n# \u7b7e\u5230\u6b21\u6570\nsign_count = sign_user.sign_count\n\n# \u53cc\u500d\u7b7e\u5230\u589e\u52a0\u6982\u7387\nadd_probability = sign_user.add_probability\n\n# \u4fee\u6539\u597d\u611f\u5ea6\nsign_user.impression = sign_user.impression + 100\nawait sign_user.save()\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u91d1\u5e01\u9053\u5177",children:"\u91d1\u5e01/\u9053\u5177"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:'from zhenxun.models.user_console import UserConsole\n\n# \u83b7\u53d6\u7528\u6237\u6570\u636e\nuser = await UserConsole.get_user(user_id)\n\n# \u7528\u6237\u91d1\u5e01\ngold = user.gold\n\n# \u7528\u6237\u9053\u5177\nprops = user.props\n\n# \u589e\u52a0\u91d1\u5e01\u65b9\u6cd5\nasync def add_gold(\n    cls, user_id: str, gold: int, source: str, platform: str | None = None\n):\n    """\u6dfb\u52a0\u91d1\u5e01\n\n    \u53c2\u6570:\n        user_id: \u7528\u6237id\n        gold: \u91d1\u5e01\n        source: \u6765\u6e90\n        platform: \u5e73\u53f0.\n    """\n    ...\n# \u4f8b\u5982\uff0c\u7528\u623712345678\u4ece\u7b7e\u5230\u83b7\u53d6100\u91d1\u5e01\nawait UserConsole.add_gold(12345678, 100, \'sign_in\')\n\n# \u51cf\u5c11\u91d1\u5e01\u65b9\u6cd5\nfrom zhenxun.utils.enum import GoldHandle\n\nasync def reduce_gold(\n    cls,\n    user_id: str,\n    gold: int,\n    handle: GoldHandle,\n    plugin_module: str,\n    platform: str | None = None,\n):\n    """\u6d88\u8017\u91d1\u5e01\n\n    \u53c2\u6570:\n        user_id: \u7528\u6237id\n        gold: \u91d1\u5e01\n        handle: \u91d1\u5e01\u5904\u7406\n        plugin_name: \u63d2\u4ef6\u6a21\u5757\n        platform: \u5e73\u53f0.\n\n    \u5f02\u5e38:\n        InsufficientGold: \u91d1\u5e01\u4e0d\u8db3\n    """\n    ...\n# \u4f8b\u5982\uff0c\u7528\u623712345678\u4ece\u8d2d\u4e70\u9053\u5177\u82b1\u8d39200\u91d1\u5e01\nawait UserConsole.reduce_gold(12345678, 200, GoldHandle.BUY , \'shop\')\n\n\n# \u9053\u5177\u589e\u52a0\u65b9\u6cd5\uff08\u4f7f\u7528\u9053\u5177uuid\uff09\nasync def add_props(\n    cls, user_id: str, goods_uuid: str, num: int = 1, platform: str | None = None\n):\n    """\u6dfb\u52a0\u9053\u5177\n\n    \u53c2\u6570:\n        user_id: \u7528\u6237id\n        goods_uuid: \u9053\u5177uuid\n        num: \u9053\u5177\u6570\u91cf.\n        platform: \u5e73\u53f0.\n    """\n    ...\n# \u4f8b\u5982\uff0c\u7528\u623712345678\u589e\u52a01\u4e2a\u9053\u5177\nawait UserConsole.add_props(12345678, \'dfwenoignwqwe-qwe21ddd-2\', 1)\n\n# \u9053\u5177\u589e\u52a0\u65b9\u6cd5\uff08\u4f7f\u7528\u9053\u5177\u540d\u79f0\uff09\nasync def add_props_by_name(\n    cls, user_id: str, name: str, num: int = 1, platform: str | None = None\n):\n    """\u6839\u636e\u540d\u79f0\u6dfb\u52a0\u9053\u5177\n\n    \u53c2\u6570:\n        user_id: \u7528\u6237id\n        name: \u9053\u5177\u540d\u79f0\n        num: \u9053\u5177\u6570\u91cf.\n        platform: \u5e73\u53f0.\n    """\n    ...\n# \u4f8b\u5982\uff0c\u7528\u623712345678\u589e\u52a01\u4e2a\u9053\u5177\nawait UserConsole.add_props_by_name(12345678, \'\u6d4b\u8bd5\u9053\u5177A\', 1)\n\n\n# \u4f7f\u7528\u9053\u5177\u65b9\u6cd5\uff08\u63a8\u8350\uff0c\u4f7f\u7528\u9053\u5177uuid\uff09\nasync def use_props(\n    cls, user_id: str, goods_uuid: str, num: int = 1, platform: str | None = None\n):\n    """\u6dfb\u52a0\u9053\u5177\n\n    \u53c2\u6570:\n        user_id: \u7528\u6237id\n        goods_uuid: \u9053\u5177uuid\n        num: \u9053\u5177\u6570\u91cf.\n        platform: \u5e73\u53f0.\n    """\n    ...\n# \u4f8b\u5982\uff0c\u7528\u623712345678\u4f7f\u75281\u4e2a\u9053\u5177\nawait UserConsole.use_props(12345678, \'dfwenoignwqwe-qwe21ddd-2\', 1)\n\n# \u4f7f\u7528\u9053\u5177\u65b9\u6cd5\uff08\u4f7f\u7528\u9053\u5177\u540d\u79f0\uff09\nasync def use_props_by_name(\n    cls, user_id: str, name: str, num: int = 1, platform: str | None = None\n):\n    """\u6839\u636e\u540d\u79f0\u6dfb\u52a0\u9053\u5177\n\n    \u53c2\u6570:\n        user_id: \u7528\u6237id\n        name: \u9053\u5177\u540d\u79f0\n        num: \u9053\u5177\u6570\u91cf.\n        platform: \u5e73\u53f0.\n    """\n    ...\n# \u4f8b\u5982\uff0c\u7528\u623712345678\u4f7f\u75281\u4e2a\u9053\u5177\nawait UserConsole.use_props_by_name(12345678, \'\u6d4b\u8bd5\u9053\u5177A\', 1)\n'})}),"\n",(0,o.jsx)(e.h2,{id:"\u597d\u53cb\u7fa4\u7ec4\u5217\u8868",children:"\u597d\u53cb/\u7fa4\u7ec4\u5217\u8868"}),"\n",(0,o.jsx)(e.h3,{id:"\u597d\u53cb\u5217\u8868",children:"\u597d\u53cb\u5217\u8868"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:"from zhenxun.utils.platform import PlatformUtils\n\n# \u83b7\u53d6\u597d\u53cb\u5217\u8868\uff0c\u5e73\u53f0\nfriend_list, platform = await PlatformUtils.get_friend_list(bot)\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u7fa4\u7ec4\u5217\u8868",children:"\u7fa4\u7ec4\u5217\u8868"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:"from zhenxun.utils.platform import PlatformUtils\n\n# \u83b7\u53d6\u7fa4\u7ec4\u5217\u8868\uff0c\u5e73\u53f0\ngroup_list, platform = await PlatformUtils.get_group_list(bot)\n"})}),"\n",(0,o.jsx)(e.h2,{id:"\u5176\u4ed6",children:"\u5176\u4ed6"}),"\n",(0,o.jsx)(e.h3,{id:"\u83b7\u53d6\u5e73\u53f0",children:"\u83b7\u53d6\u5e73\u53f0"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:'from nonebot import on_command, Bot\nfrom nonebot_plugin_uninfo import Uninfo\nfrom zhenxun.utils.platform import get_platform\n\n_matcher = on_command("test")\n\n@_matcher.handle()\nasync def _(bot: Bot, session: Uninfo):\n    # \u83b7\u53d6\u5e73\u53f0\uff0c\u4f7f\u7528Bot\n    platform = await PlatformUtils.get_platform(bot)\n    # \u83b7\u53d6\u5e73\u53f0\uff0c\u4f7f\u7528Uninfo\n    platform = await PlatformUtils.get_platform(session)\n'})})]})}function m(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(u,{...n})}):u(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>i,x:()=>d});var o=s(6540);const t={},r=o.createContext(t);function i(n){const e=o.useContext(r);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:i(n.components),o.createElement(r.Provider,{value:e},n.children)}}}]);